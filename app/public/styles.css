:root{--bg-main:#121212;--bg-secondary:#000;--bg-tertiary:#181818;--bg-highlight:#2a2a2a;--accent:#1DB954;--text-primary:#fff;--text-secondary:#b3b3b3;--font-family:'Segoe UI','Roboto',sans-serif;--danger:#e74c3c;--dynamic-bg-color:transparent;--fs-dynamic-bg:var(--bg-tertiary)}
html,body{margin:0;padding:0;font-family:var(--font-family);background-color:var(--bg-main);color:var(--text-primary);overflow-x:hidden;height:100vh}
#app-container{height:100vh;display:flex;flex-direction:column}
.app-layout{display:grid;grid-template-areas:"sidebar main" "now-playing now-playing";grid-template-columns:250px 1fr;grid-template-rows:1fr auto;height:100%;transition:filter .3s ease;overflow:hidden}
#app-container.fs-active .app-layout{filter:blur(10px) brightness(0.5)}
.sidebar{grid-area:sidebar;background-color:var(--bg-secondary);padding:20px;display:flex;flex-direction:column;gap:20px;z-index:1002}
.main-content{grid-area:main;background-color:var(--bg-main);overflow-y:auto;padding:30px}
.main-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;}
#view-title { flex-grow: 1; }
/* --- NEW SEARCH BAR STYLES --- */
.search-bar-container{margin-bottom:25px;position:relative}
#search-input{width:100%;max-width:400px;padding:12px 12px 12px 40px;border-radius:25px;border:none;background-color:var(--bg-highlight);color:var(--text-primary);font-size:1rem;transition:background-color .2s}
#search-input:focus{outline:none;background-color:#333}
#search-input::placeholder{color:var(--text-secondary)}
.search-bar-container::before{content:'';position:absolute;left:15px;top:50%;transform:translateY(-50%);width:20px;height:20px;background-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%23b3b3b3"><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/></svg>');background-repeat:no-repeat;opacity:0.7}
/* --- END SEARCH BAR STYLES --- */
.view-switcher{display:flex;gap:8px;}
.view-btn{background:none;border:none;cursor:pointer;opacity:0.6;}
.view-btn.active{opacity:1;}
.view-btn svg{width:24px;height:24px;fill:var(--text-primary);}
.now-playing-bar{grid-area:now-playing;background:linear-gradient(90deg, var(--dynamic-bg-color), var(--bg-tertiary) 70%);border-top:1px solid var(--bg-highlight);display:flex;align-items:center;justify-content:space-between;padding:16px 24px;gap:20px;transition:background .5s ease-in-out;z-index:100}
.now-playing-bar .track-info{flex:1;min-width:0;}
.now-playing-bar .player-controls{flex:2;display:flex;justify-content:center;}
.now-playing-bar .player-actions{flex:1;display:flex;justify-content:flex-end;gap:10px}
.sidebar h2,.sidebar h3{margin:0}
.nav-links,#playlist-list{list-style:none;padding:0;margin:0}
.nav-links li,#playlist-list li{padding:10px;border-radius:5px;cursor:pointer;font-weight:600;opacity:0.7;transition:all .2s;user-select:none}
.nav-links li:hover,#playlist-list li:hover{opacity:1;background-color:var(--bg-highlight)}
#playlist-list li.drop-target{background-color:var(--accent);color:#000;transform:scale(1.05)}
.nav-links li.active,#playlist-list li.active{opacity:1;color:var(--accent)}
.playlists-section{display:flex;flex-direction:column;gap:10px;overflow-y:auto;flex:1 1 auto;min-height:0;}
.playlists-section::-webkit-scrollbar{width:12px}
.playlists-section::-webkit-scrollbar-thumb{background-color:var(--bg-highlight);border:4px solid var(--bg-secondary);border-radius:10px}
.playlists-section::-webkit-scrollbar-track{background:transparent}
.create-playlist-wrapper{display:flex;margin-top:auto;padding-top:10px}
#new-playlist-name{flex-grow:1;background:var(--bg-highlight);border:1px solid #444;color:var(--text-primary);padding:8px;border-radius:5px 0 0 5px;border-right:none;width:0; min-width:0;}
#create-playlist-btn{background:var(--accent);border:none;color:#000;font-weight:700;padding:0 12px;border-radius:0 5px 5px 0;cursor:pointer}
.view{display:none}.view.active{display:block}
.song-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(180px,1fr));gap:20px}
.song-card{background:var(--bg-tertiary);border-radius:8px;padding:15px;cursor:pointer;transition:.2s;position:relative;overflow:hidden;user-select:none}
.song-card.selected{outline:2px solid var(--accent);background:var(--bg-highlight)}
.song-card.playing{background:var(--accent)!important;color:#000}
.song-card.playing .song-artist{color:#333}
.cover-art-wrapper,.song-title,.song-artist{pointer-events:none}
.cover-art-wrapper{width:100%;aspect-ratio:1/1;border-radius:5px;overflow:hidden;margin-bottom:10px}
.cover-art-wrapper img{width:100%;height:100%;object-fit:cover}
.song-title{font-weight:600;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.song-artist{font-size:.9em;color:var(--text-secondary);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.song-list{display:none;}
.song-list-header{display:grid;grid-template-columns:40px 4fr 3fr 2fr 100px;gap:15px;padding:0 15px;margin-bottom:10px;color:var(--text-secondary);font-size:0.9rem;border-bottom:1px solid var(--bg-highlight);padding-bottom:10px;}
.header-item:first-child{text-align:right;}
.song-row{display:grid;grid-template-columns:40px 4fr 3fr 2fr 100px;gap:15px;padding:10px 15px;border-radius:5px;cursor:pointer;align-items:center;transition:background-color 0.2s;}
.song-row:hover{background-color:var(--bg-highlight);}
.song-row.playing{background-color:var(--accent);color:#000;}
.song-row.playing .song-row-artist, .song-row.playing .song-row-album, .song-row.playing .song-row-date, .song-row.playing .song-row-duration {color:#333;}
.song-row-index{color:var(--text-secondary);text-align:right;}
.song-row-title-artist{display:flex;align-items:center;gap:15px;}
.song-row-cover{width:40px;height:40px;border-radius:4px;object-fit:cover;}
.song-row-details{display:flex;flex-direction:column;}
.song-row-title{font-weight:600;}
.song-row-artist{font-size:0.9rem;color:var(--text-secondary);}
.song-row-album, .song-row-date, .song-row-duration{color:var(--text-secondary);font-size:0.9rem;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}
.upload-container{max-width:600px;margin:auto;text-align:center}
.upload-container h3 { margin-bottom: 20px; }
.file-drop-area{display:flex;align-items:center;justify-content:center;padding:40px;border:2px dashed var(--text-secondary);border-radius:5px;transition:.3s;cursor:pointer}
.file-drop-area.is-active{border-color:var(--accent);background:rgba(29,185,84,0.1)}
.file-input{display:none}
#upload-preview-wrapper{margin-top:15px;display:none}
#upload-preview{max-height:200px;overflow-y:auto;background:var(--bg-secondary);border-radius:5px;padding:5px;list-style:none}
#upload-preview li{padding:5px 10px;font-size:.9em}
#upload-form button{width:100%;padding:12px;margin-top:15px;background:var(--accent);color:#000;font-weight:700;border:none;border-radius:5px;cursor:pointer}
.track-info{display:flex;align-items:center;gap:15px;min-width:0; cursor: pointer;}
#mobile-play-pause-btn{display:none;}
#current-track-cover{width:60px;height:60px;object-fit:cover;border-radius:4px}
.track-details{display:flex;flex-direction:column;min-width:0; justify-content:center;}
.like-btn{background:none;border:none;cursor:pointer;padding:5px;transition:.2s}
.like-btn svg { opacity: 0.7; transition: all 0.2s; }
.like-btn:hover svg { opacity: 1; }
.like-btn.liked svg { fill: var(--accent) !important; opacity: 1; }
#like-btn-player svg{width:20px;height:20px}
#audio-player{display:none}
.custom-player-ui{display:flex;flex-direction:column;align-items:center;width:100%;max-width:700px;gap:8px}
.player-buttons{display:flex;align-items:center;gap:16px}
.control-btn{background:none;border:none;cursor:pointer;padding:0;position:relative}
.control-btn svg{display:block;width:20px;height:20px; opacity: 0.7; transition: all .2s;}
.control-btn:hover svg{opacity: 1;}
.control-btn.active svg{fill:var(--accent) !important; opacity: 1;}
.main-control{width:40px;height:40px;border-radius:50%;border:none;background-color:var(--text-primary);cursor:pointer;display:flex;justify-content:center;align-items:center;transition:.2s}
.main-control:hover{transform:scale(1.1)}
.main-control.play-btn::after{content:'';display:block;width:0;height:0;border-top:8px solid transparent;border-bottom:8px solid transparent;border-left:14px solid #000;margin-left:4px}
.main-control.pause-btn::after{content:'';display:block;width:12px;height:14px;border-left:4px solid #000;border-right:4px solid #000;box-sizing:border-box}
.progress-section{display:flex;align-items:center;width:100%;gap:10px;font-size:.9em;color:var(--text-secondary)}
.progress-container{flex-grow:1;height:6px;background:var(--bg-highlight);border-radius:5px;cursor:pointer}
.progress-bar-fill{height:100%;width:0%;border-radius:5px;background:linear-gradient(90deg, var(--accent), #24c298);transition:width .1s linear}
.full-screen-player{position:fixed;inset:0;z-index:1001;display:flex;flex-direction:column;justify-content:center;align-items:center;gap:20px;opacity:0;visibility:hidden;background-color:var(--fs-dynamic-bg); padding: 20px env(safe-area-inset-right) 20px env(safe-area-inset-left); box-sizing: border-box; transition: opacity .3s ease, visibility .3s ease, transform .3s ease;}
.full-screen-player::before{content:'';position:absolute;inset:0;background:radial-gradient(circle, transparent 0%, rgba(0,0,0,0.8) 80%);backdrop-filter:blur(50px)}
.full-screen-player.visible{opacity:1;visibility:visible}
.fs-content{position:relative;z-index:2; text-align:center; display: flex; flex-direction: column; align-items: center; justify-content: center; width: 100%; max-width: 500px;}
#fs-cover-art{width:100%;max-width:40vh;aspect-ratio:1/1;border-radius:10px;box-shadow:0 10px 30px rgba(0,0,0,0.5)}
.fs-track-details {width: 100%; padding: 20px 0;}
#fs-title{font-size:1.8rem;margin:0 0 5px 0}
#fs-artist{font-size:1.1rem;color:var(--text-secondary);margin:0}
#fs-player-controls { margin-top: 20px; width: 100%;}
#fs-player-controls .control-btn svg{fill: var(--text-primary) !important;}
#fs-player-controls .main-control { width: 60px; height: 60px; }
#fs-player-controls .control-btn svg { width: 24px; height: 24px; }
#fs-player-controls .player-buttons { gap: 25px; justify-content: center;}
#fs-player-controls .progress-section { margin-top: 20px; padding: 0 10px; box-sizing: border-box; }
#context-menu{position:fixed;z-index:10000;width:220px;background:var(--bg-highlight);border-radius:5px;box-shadow:0 5px 15px rgba(0,0,0,0.5);padding:5px;display:none}
.mobile-header{display:none}
.sidebar-overlay{display:none}
.drag-image{position:absolute;left:-1000px;top:-1000px;display:flex;align-items:center;background:var(--bg-highlight);border-radius:8px;padding:8px;box-shadow:0 5px 15px rgba(0,0,0,0.3);font-size:1rem;font-weight:600;z-index:11000;pointer-events:none;}
.drag-image img{width:50px;height:50px;border-radius:4px;margin-right:12px;}
.drag-image .drag-info{display:flex;flex-direction:column;align-items:flex-start;}
.drag-image .drag-info .drag-title{white-space:nowrap;font-size:0.9rem;}
.drag-image .drag-info .drag-count{font-size:0.8rem;color:var(--text-secondary);}
@media (max-width: 768px) {
    .main-header { display: none; }
    .mobile-header{display:flex; align-items:center; justify-content:space-between; background:var(--bg-secondary);padding:10px 15px;padding-top:calc(10px + env(safe-area-inset-top));gap:15px;position:sticky;top:0;z-index:1003; transition: background-color .3s ease;}
    #app-container.fs-active .mobile-header {background: transparent;}
    .hamburger-btn{background:none;border:none;color:var(--text-primary);font-size:1.5rem;cursor:pointer}
    .app-layout{display:flex;flex-direction:column;height:100%;}
    .main-content{flex:1;min-height:0;}
    .now-playing-bar{display:grid;grid-template-columns:1fr auto;padding:10px 15px;flex-shrink:0;}
    .now-playing-bar .player-controls {display: none;}
    .sidebar{position:fixed;top:0;left:0;height:100%;transform:translateX(-100%);transition:transform .3s ease-in-out; z-index: 1004; padding-top: calc(20px + env(safe-area-inset-top));}
    .sidebar.visible{transform:translateX(0)}
    .sidebar-overlay{position:fixed;inset:0;background:rgba(0,0,0,0.5);z-index:1003;display:none}
    .sidebar-overlay.visible{display:block}
    .main-content{padding:15px}
    #search-input { max-width: 100%; }
    .song-grid{grid-template-columns:repeat(auto-fill,minmax(140px,1fr));gap:15px}
    .song-list-header{grid-template-columns:4fr 3fr; padding: 0 10px;}
    .song-list-header .header-item:first-child, .song-list-header .header-item:nth-child(4), .song-list-header .header-item:nth-child(5) {display:none;}
    .song-row{grid-template-columns:4fr 3fr; padding: 10px;}
    .song-row-index, .song-row-date, .song-row-duration {display:none;}
    .player-actions { gap: 10px; }
    #mobile-play-pause-btn { display: flex; }
    .track-details span{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
    #current-track-title{max-width:calc(100vw - 180px)}
    .track-info{gap:10px}
    #toast-container{bottom:80px}
}
